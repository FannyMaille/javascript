<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exercice 1</title>
</head>

<body>
</body>
<script type="text/javascript">

  function generatesurname(array) {
    if (array['surname'].length >= 3) {
      const consonnes = array['surname'].toUpperCase().match(/[bcdfghjklmnpqrstvwxz]/gi).slice(0, 3);
      if (consonnes.length < 3) {
        const voyelles = array['surname'].toUpperCase().match(/[aeiouy]/gi).slice(0, 2);
        if (consonnes.length == 1) {
          consonnes.push(voyelles[0], voyelles[1]);
        }
        if (consonnes.length == 2) {
          consonnes.push(voyelles[0]);
        }
      }
      return consonnes.join("");
    }
    else {
      if (array['surname'].length == 1) {
        return array['surname'].toUpperCase() + 'X', 'X';
      }
      if (array['surname'].length == 2) {
        return array['surname'].toUpperCase() + 'X';
      }
    }
  }

  function generatename(array) {
    if (array['name'].length >= 3) {
      const consonnes = array['name'].toUpperCase().match(/[bcdfghjklmnpqrstvwxz]/gi);
      if (consonnes.length == 3) {
        return consonnes.join("");
      }
      if (consonnes.length > 3) {
        const bigname = consonnes[0] + consonnes[2] + consonnes[3];
        return bigname;
      }
      else {
        const voyelles = array['name'].toUpperCase().match(/[aeiouy]/gi).slice(0, 2);
        if (consonnes.length == 1) {
          consonnes.push(voyelles[0], voyelles[1]);
        }
        if (consonnes.length == 2) {
          consonnes.push(voyelles[0]);
        }
        return consonnes.join("");
      }
    }
    else {
      if (array['name'].length == 1) {
        return array['name'].toUpperCase() + 'X', 'X';
      }
      if (array['name'].length == 2) {
        return array['name'].toUpperCase() + 'X';
      }
    }
  }

  function generatedate(array) {
    let dob = array['dob'].slice(-2);
    const month = array['dob'].split("/")[1];
    switch (month) {
      case '1':
        dob += "A";
        break;
      case '2':
        dob += "B";
        break;
      case '3':
        dob += "C";
        break;
      case '4':
        dob += "D";
        break;
      case '5':
        dob += "E";
        break;
      case '6':
        dob += "H";
        break;
      case '7':
        dob += "L";
        break;
      case '8':
        dob += "M";
        break;
      case '9':
        dob += "P";
        break;
      case '10':
        dob += "R";
        break;
      case '11':
        dob += "S";
        break;
      case '12':
        dob += "T";
        break;
    }
    let day = array['dob'].split("/")[0];
    switch (array['gender']) {
      case 'M':
        if (day < 9) {
          day = "0" + day;
        }
        break;
      case 'F':
        day = 40 + parseInt(day);
        break;
    }
    return dob += day.toString();
  }

  function fiscalCode(array) {
   return generatesurname(array)+ generatename(array) + generatedate(array);
  }

  console.log(fiscalCode({
    name: 'Bob',
    surname: 'yu',
    gender: 'F',
    dob: '5/4/1999'
  }));

</script>

</html>